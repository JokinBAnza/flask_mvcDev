{% extends "base.html" %}

{% block title %}Libros{% endblock %}

{% block content %}
<div style="padding-bottom: 100px;"> {# Ajusta según la altura de tu footer #}

<h1>Libros</h1>

<div style="margin-bottom: 20px;">
    <button onclick="location.href='{{ url_for('libros.listar', disponibles=1) }}'" style="padding: 10px 20px;">
        Ver solo libros disponibles
    </button>
</div>

<form method="GET" action="{{ url_for('libros.buscar') }}" style="margin-bottom: 20px;">
    <input type="text" name="q" placeholder="Buscar libro..." value="{{ busqueda|default('') }}">
    <button type="submit">Buscar</button>
</form>

{% if libros %}
<table style="width:100%; border-collapse: collapse; margin-bottom: 20px;">
    <thead>
        <tr style="background-color: #f0f0f0;">
            <th style="padding: 10px; border: 1px solid #ccc;">Título</th>
            <th style="padding: 10px; border: 1px solid #ccc;">Autor</th>
            <th style="padding: 10px; border: 1px solid #ccc;">Estado</th>
            <th style="padding: 10px; border: 1px solid #ccc;">Acciones</th>
        </tr>
    </thead>
    <tbody>
    {% for libro in libros %}
<tr>
    <td style="padding: 10px; border: 1px solid #ccc;">
        <a href="{{ url_for('libros.detalle', id=libro.id) }}">{{ libro.titulo }}</a>
    </td>
    <td style="padding: 10px; border: 1px solid #ccc;">{{ libro.autor }}</td>
    <td style="padding: 10px; border: 1px solid #ccc;">
        {% if libro.socio %}
            Prestado
        {% else %}
            Disponible
        {% endif %}
    </td>
    <td style="padding: 10px; border: 1px solid #ccc; text-align: center; vertical-align: middle;">
    {% if not libro.socio %}
    <form method="POST" action="{{ url_for('libros.borrar', libro_id=libro.id) }}" style="display:flex; justify-content:center; align-items:center; margin:0;">
        <button type="submit" onclick="return confirm('¿Estás seguro de que quieres borrar este libro?');" style="padding:5px 10px; font-size:14px;">
            Borrar
        </button>
    </form>
    {% else %}
        No disponible
    {% endif %}
</td>


</tr>
{% endfor %}
    </tbody>
</table>

{% else %}
<p>No se encontraron libros que coincidan con tu búsqueda.</p>
{% endif %}

<div style="margin-top: 20px; text-align: right;">
    <button style="padding: 10px 20px;" onclick="location.href='{{ url_for('libros.crear') }}'">Crear nuevo libro</button>
</div>

</div> {# Fin del padding-bottom #}
{% endblock %}
